@namespace BlazorUI.Components.ScrollArea

<div class="@CssClass">
    <div class="@ViewportClass" style="@ViewportStyle">
        @ChildContent
    </div>
    @if (ShowScrollbar)
    {
        <ScrollBar Orientation="@Orientation" />
    }
</div>

@code {
    [Parameter]
    public string? Class { get; set; }

    [Parameter]
    public string? ViewportClass { get; set; }

    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    [Parameter]
    public ScrollAreaType Type { get; set; } = ScrollAreaType.Hover;

    [Parameter]
    public ScrollAreaOrientation Orientation { get; set; } = ScrollAreaOrientation.Vertical;

    [Parameter]
    public string? Height { get; set; }

    [Parameter]
    public string? MaxHeight { get; set; }

    private bool ShowScrollbar => Type != ScrollAreaType.Hidden;

    private string ViewportStyle
    {
        get
        {
            var styles = new List<string>();
            if (!string.IsNullOrEmpty(Height))
                styles.Add($"height: {Height}");
            if (!string.IsNullOrEmpty(MaxHeight))
                styles.Add($"max-height: {MaxHeight}");
            return string.Join("; ", styles);
        }
    }

    private string CssClass => BlazorUI.Components.Utilities.ClassNames.cn(
        "relative overflow-hidden",
        Class
    );

    private string ComputedViewportClass => BlazorUI.Components.Utilities.ClassNames.cn(
        "h-full w-full rounded-[inherit]",
        Orientation switch
        {
            ScrollAreaOrientation.Vertical => "overflow-y-auto overflow-x-hidden",
            ScrollAreaOrientation.Horizontal => "overflow-x-auto overflow-y-hidden",
            ScrollAreaOrientation.Both => "overflow-auto",
            _ => "overflow-y-auto overflow-x-hidden"
        },
        Type == ScrollAreaType.Always ? "scrollbar-always" : "scrollbar-auto",
        ViewportClass
    );
}
