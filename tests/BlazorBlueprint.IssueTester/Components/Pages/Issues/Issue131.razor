@page "/issues/131"
@using BlazorBlueprint.Components.ButtonGroup
@using BlazorBlueprint.Components.Dialog
@using BlazorBlueprint.Components.DropdownMenu

<PageTitle>Issue #131 - Nested Button Group Styling Bug</PageTitle>

<div class="max-w-3xl space-y-6">
    <div class="space-y-2">
        <h1 class="text-3xl font-bold tracking-tight">Issue #131</h1>
        <p class="text-muted-foreground">
            <strong>Bug:</strong> Nested rendering of button groups / dialog trigger.
            When a Button exists within a DialogTrigger inside a ButtonGroup,
            the button renders its own full border rather than adopting the button group styling.
        </p>
    </div>

    <div class="rounded-lg border border-border p-6 space-y-6">
        <h2 class="text-xl font-semibold">Reproduction</h2>

        <div class="space-y-4">
            <h3 class="text-sm font-medium text-muted-foreground">1. Working: ButtonGroup with plain Buttons (no nesting)</h3>
            <ButtonGroup AriaLabel="Plain button group">
                <Button Variant="ButtonVariant.Outline">Archive</Button>
                <Button Variant="ButtonVariant.Outline">Move</Button>
                <Button Variant="ButtonVariant.Outline">Delete</Button>
            </ButtonGroup>
        </div>

        <div class="space-y-4">
            <h3 class="text-sm font-medium text-muted-foreground">2. Fixed: ButtonGroup with a Dialog wrapping one of the buttons (AsChild now defaults to true)</h3>
            <ButtonGroup AriaLabel="Button group with dialog trigger">
                <Button Variant="ButtonVariant.Outline">Archive</Button>
                <Dialog>
                    <DialogTrigger>
                        <Button Variant="ButtonVariant.Outline">More Actions</Button>
                    </DialogTrigger>
                    <DialogContent>
                        <DialogHeader>
                            <DialogTitle>More Actions</DialogTitle>
                            <DialogDescription>Choose an additional action to perform.</DialogDescription>
                        </DialogHeader>
                        <DialogFooter>
                            <Button Variant="ButtonVariant.Outline">Cancel</Button>
                            <Button>Confirm</Button>
                        </DialogFooter>
                    </DialogContent>
                </Dialog>
                <Button Variant="ButtonVariant.Outline">Delete</Button>
            </ButtonGroup>
        </div>

        <div class="space-y-4">
            <h3 class="text-sm font-medium text-muted-foreground">3. Fixed: ButtonGroup with DialogTrigger (AsChild is now the default)</h3>
            <ButtonGroup AriaLabel="Button group with dialog trigger as child">
                <Button Variant="ButtonVariant.Outline">Archive</Button>
                <Dialog>
                    <DialogTrigger>
                        <Button Variant="ButtonVariant.Outline">More Actions</Button>
                    </DialogTrigger>
                    <DialogContent>
                        <DialogHeader>
                            <DialogTitle>More Actions</DialogTitle>
                            <DialogDescription>Choose an additional action to perform.</DialogDescription>
                        </DialogHeader>
                        <DialogFooter>
                            <Button Variant="ButtonVariant.Outline">Cancel</Button>
                            <Button>Confirm</Button>
                        </DialogFooter>
                    </DialogContent>
                </Dialog>
                <Button Variant="ButtonVariant.Outline">Delete</Button>
            </ButtonGroup>
        </div>

        <div class="space-y-4">
            <h3 class="text-sm font-medium text-muted-foreground">4. DropdownMenu in ButtonGroup</h3>
            <ButtonGroup AriaLabel="Button group with dropdown menu">
                <Button Variant="ButtonVariant.Outline">Archive</Button>
                <DropdownMenu>
                    <DropdownMenuTrigger>
                        <Button Variant="ButtonVariant.Outline">More Actions</Button>
                    </DropdownMenuTrigger>
                    <DropdownMenuContent>
                        <DropdownMenuItem>Move to folder</DropdownMenuItem>
                        <DropdownMenuItem>Copy link</DropdownMenuItem>
                        <DropdownMenuSeparator />
                        <DropdownMenuItem>Mark as read</DropdownMenuItem>
                    </DropdownMenuContent>
                </DropdownMenu>
                <Button Variant="ButtonVariant.Outline">Delete</Button>
            </ButtonGroup>
        </div>
    </div>

    <div class="rounded-lg border border-border p-6 space-y-4">
        <h2 class="text-xl font-semibold">Expected Behavior</h2>
        <p class="text-sm text-muted-foreground">
            The "More Actions" button inside the DialogTrigger should adopt the ButtonGroup's
            connected styling (shared borders, no rounded corners between adjacent buttons),
            identical to scenario 1 above.
        </p>
    </div>

    <div class="rounded-lg border border-border p-6 space-y-4">
        <h2 class="text-xl font-semibold">Actual Behavior</h2>
        <p class="text-sm text-muted-foreground">
            The Button inside the DialogTrigger renders with its own full border and rounded
            corners, breaking the connected appearance of the ButtonGroup. This is because
            ButtonGroup's CSS selectors target direct child <code class="rounded bg-muted px-1.5 py-0.5 text-sm">&gt; button</code> elements,
            but the Dialog/DialogTrigger wrapper inserts intermediate DOM elements between
            the ButtonGroup and the Button.
        </p>
    </div>
</div>
